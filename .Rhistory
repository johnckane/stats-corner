arrange(desc(cum_points)) %>%
slice(1:10)
through_week <-
games_played%>%
filter(as.numeric(week) <= week_num) %>%
group_by(year_owner) %>%
arrange(as.numeric(week)) %>%
mutate(cum_points = cumsum(points))
through_week_top10 <-
through_week %>%
ungroup() %>%
filter(as.numeric(week) == week_num) %>%
arrange(desc(cum_points)) %>%
slice(1:10) %>%
filter(year == 2018)
plot <- ggplot(data = total %>% ungroup %>% inner_join(top10, by = "year_owner") %>% filter(as.numeric(week.x) >= week_num),
aes(x = as.numeric(week.x), y = cum_points.x, group = year_owner, label = year_owner))
plot +
geom_point(pch = 1) +
geom_line(linetype = 'dotted') +
geom_text_repel(data = total %>% ungroup() %>% inner_join(top10, by = "year_owner") %>% filter(as.numeric(week.x) == 13),
aes(x = as.numeric(week.x), y = cum_points.x),
nudge_x = 1.5,
direction = "y",
segment.alpha = 0) +
geom_point(data = through_week %>% ungroup() %>% inner_join(through_week_top10, by = "year_owner") %>% filter(as.numeric(week.x) == week_num),
aes(x = as.numeric(week.x), y = cum_points.x, group = year_owner),
colour = 'red') +
#geom_line(data = through_week %>% ungroup() %>% inner_join(through_week_top10, by = "year_owner"),
#          aes(x = as.numeric(week.x), y = cum_points.x, group = year_owner),
#          colour = 'red') +
geom_text_repel(data = through_week %>% ungroup() %>% inner_join(through_week_top10, by = "year_owner") %>% filter(as.numeric(week.x) == week_num),
aes(x = as.numeric(week.x), y = cum_points.x),
nudge_x = -1,
#nudge_y = 100,
#direction = "y",
#segment.alpha = 0,
colour = 'red') +
ggtitle("Top 10 Single Season Point Leaders",
sub = paste0("Point Totals Through ",as.character(week_num)," Weeks; 2018 Teams in Red")) +
scale_y_continuous("Cumulative Points", lim = c(800,1650)) +
scale_x_continuous("Week", lim = c(7,18),
breaks = c(9,10,11,12,13),
labels = c("9","10","11","12","13")) +
theme(legend.position = 'none') +
theme_minimal()
week_num <- 10
total <-
games_played %>%
group_by(year_owner) %>%
arrange(as.numeric(week)) %>%
mutate(cum_points = cumsum(points))
top10 <-
total %>%
ungroup() %>%
filter(as.numeric(week) == 13) %>%
arrange(desc(cum_points)) %>%
slice(1:10)
through_week <-
games_played%>%
filter(as.numeric(week) <= week_num) %>%
group_by(year_owner) %>%
arrange(as.numeric(week)) %>%
mutate(cum_points = cumsum(points))
through_week_top10 <-
through_week %>%
ungroup() %>%
filter(as.numeric(week) == week_num) %>%
arrange(desc(cum_points)) %>%
slice(1:10) %>%
filter(year == 2018)
plot <- ggplot(data = total %>% ungroup %>% inner_join(top10, by = "year_owner") %>% filter(as.numeric(week.x) >= week_num),
aes(x = as.numeric(week.x), y = cum_points.x, group = year_owner, label = year_owner, colour = year_owner))
plot +
geom_point(pch = 1) +
geom_line(linetype = 'dotted') +
geom_text_repel(data = total %>% ungroup() %>% inner_join(top10, by = "year_owner") %>% filter(as.numeric(week.x) == 13),
aes(x = as.numeric(week.x), y = cum_points.x),
nudge_x = 1.5,
direction = "y",
segment.alpha = 0) +
geom_point(data = through_week %>% ungroup() %>% inner_join(through_week_top10, by = "year_owner") %>% filter(as.numeric(week.x) == week_num),
aes(x = as.numeric(week.x), y = cum_points.x, group = year_owner),
colour = 'red') +
#geom_line(data = through_week %>% ungroup() %>% inner_join(through_week_top10, by = "year_owner"),
#          aes(x = as.numeric(week.x), y = cum_points.x, group = year_owner),
#          colour = 'red') +
geom_text_repel(data = through_week %>% ungroup() %>% inner_join(through_week_top10, by = "year_owner") %>% filter(as.numeric(week.x) == week_num),
aes(x = as.numeric(week.x), y = cum_points.x),
nudge_x = -1,
#nudge_y = 100,
#direction = "y",
#segment.alpha = 0,
colour = 'red') +
ggtitle("Top 10 Single Season Point Leaders",
sub = paste0("Point Totals Through ",as.character(week_num)," Weeks; 2018 Teams in Red")) +
scale_y_continuous("Cumulative Points", lim = c(1000,1650)) +
scale_x_continuous("Week", lim = c(8,18),
breaks = c(10,11,12,13),
labels = c("10","11","12","13")) +
theme(legend.position = 'none') +
theme_minimal()
week_num <- 10
total <-
games_played %>%
group_by(year_owner) %>%
arrange(as.numeric(week)) %>%
mutate(cum_points = cumsum(points))
top10 <-
total %>%
ungroup() %>%
filter(as.numeric(week) == 13) %>%
arrange(desc(cum_points)) %>%
slice(1:10)
through_week <-
games_played%>%
filter(as.numeric(week) <= week_num) %>%
group_by(year_owner) %>%
arrange(as.numeric(week)) %>%
mutate(cum_points = cumsum(points))
through_week_top10 <-
through_week %>%
ungroup() %>%
filter(as.numeric(week) == week_num) %>%
arrange(desc(cum_points)) %>%
slice(1:10) %>%
filter(year == 2018)
plot <- ggplot(data = total %>% ungroup %>% inner_join(top10, by = "year_owner") %>% filter(as.numeric(week.x) >= week_num),
aes(x = as.numeric(week.x), y = cum_points.x, group = year_owner, label = year_owner, colour = year_owner))
plot +
geom_point(pch = 1) +
geom_line(linetype = 'dotted') +
geom_text_repel(data = total %>% ungroup() %>% inner_join(top10, by = "year_owner") %>% filter(as.numeric(week.x) == 13),
aes(x = as.numeric(week.x), y = cum_points.x),
nudge_x = 1.5,
direction = "y",
segment.alpha = 0) +
geom_point(data = through_week %>% ungroup() %>% inner_join(through_week_top10, by = "year_owner") %>% filter(as.numeric(week.x) == week_num),
aes(x = as.numeric(week.x), y = cum_points.x, group = year_owner),
colour = 'red') +
#geom_line(data = through_week %>% ungroup() %>% inner_join(through_week_top10, by = "year_owner"),
#          aes(x = as.numeric(week.x), y = cum_points.x, group = year_owner),
#          colour = 'red') +
geom_text_repel(data = through_week %>% ungroup() %>% inner_join(through_week_top10, by = "year_owner") %>% filter(as.numeric(week.x) == week_num),
aes(x = as.numeric(week.x), y = cum_points.x),
nudge_x = -1,
#nudge_y = 100,
#direction = "y",
#segment.alpha = 0,
colour = 'red') +
ggtitle("Top 10 Single Season Point Leaders",
sub = paste0("Point Totals Through ",as.character(week_num)," Weeks; 2018 Teams in Red")) +
scale_y_continuous("Cumulative Points", lim = c(1000,1650)) +
scale_x_continuous("Week", lim = c(8,18),
breaks = c(10,11,12,13),
labels = c("10","11","12","13")) +
#  theme(legend.position = 'none') +
theme_minimal(legend.position = 'none')
week_num <- 10
total <-
games_played %>%
group_by(year_owner) %>%
arrange(as.numeric(week)) %>%
mutate(cum_points = cumsum(points))
top10 <-
total %>%
ungroup() %>%
filter(as.numeric(week) == 13) %>%
arrange(desc(cum_points)) %>%
slice(1:10)
through_week <-
games_played%>%
filter(as.numeric(week) <= week_num) %>%
group_by(year_owner) %>%
arrange(as.numeric(week)) %>%
mutate(cum_points = cumsum(points))
through_week_top10 <-
through_week %>%
ungroup() %>%
filter(as.numeric(week) == week_num) %>%
arrange(desc(cum_points)) %>%
slice(1:10) %>%
filter(year == 2018)
plot <- ggplot(data = total %>% ungroup %>% inner_join(top10, by = "year_owner") %>% filter(as.numeric(week.x) >= week_num),
aes(x = as.numeric(week.x), y = cum_points.x, group = year_owner, label = year_owner, colour = year_owner))
plot +
geom_point(pch = 1) +
geom_line(linetype = 'dotted') +
geom_text_repel(data = total %>% ungroup() %>% inner_join(top10, by = "year_owner") %>% filter(as.numeric(week.x) == 13),
aes(x = as.numeric(week.x), y = cum_points.x),
nudge_x = 1.5,
direction = "y",
segment.alpha = 0) +
geom_point(data = through_week %>% ungroup() %>% inner_join(through_week_top10, by = "year_owner") %>% filter(as.numeric(week.x) == week_num),
aes(x = as.numeric(week.x), y = cum_points.x, group = year_owner),
colour = 'red') +
#geom_line(data = through_week %>% ungroup() %>% inner_join(through_week_top10, by = "year_owner"),
#          aes(x = as.numeric(week.x), y = cum_points.x, group = year_owner),
#          colour = 'red') +
geom_text_repel(data = through_week %>% ungroup() %>% inner_join(through_week_top10, by = "year_owner") %>% filter(as.numeric(week.x) == week_num),
aes(x = as.numeric(week.x), y = cum_points.x),
nudge_x = -1,
#nudge_y = 100,
#direction = "y",
#segment.alpha = 0,
colour = 'red') +
ggtitle("Top 10 Single Season Point Leaders",
sub = paste0("Point Totals Through ",as.character(week_num)," Weeks; 2018 Teams in Red")) +
scale_y_continuous("Cumulative Points", lim = c(1000,1650)) +
scale_x_continuous("Week", lim = c(8,18),
breaks = c(10,11,12,13),
labels = c("10","11","12","13")) +
#  theme(legend.position = 'none') +
theme_minimal() +
guides(fill=FALSE, color=FALSE)
View(top10)
View(through_week_top10)
week_num <- 10
total <-
games_played %>%
group_by(year_owner) %>%
arrange(as.numeric(week)) %>%
mutate(cum_pw= cumsum(pw))
top10 <-
total %>%
ungroup() %>%
filter(as.numeric(week) == 13) %>%
arrange(desc(cum_pw)) %>%
slice(1:10)
through_week <-
games_played%>%
filter(as.numeric(week) <= week_num) %>%
group_by(year_owner) %>%
arrange(as.numeric(week)) %>%
mutate(cum_pw = cumsum(pw))
through_week_top10 <-
through_week %>%
ungroup() %>%
filter(as.numeric(week) == week_num) %>%
arrange(desc(cum_pw)) %>%
slice(1:10) %>%
filter(year == 2018)
plot <- ggplot(data = total %>% ungroup %>% inner_join(top10, by = "year_owner") %>% filter(as.numeric(week.x) >= week_num),
aes(x = as.numeric(week.x), y = cum_pw.x, group = year_owner, label = year_owner, colour = year_owner))
plot +
geom_point(pch = 1) +
geom_line(linetype = 'dotted') +
geom_text_repel(data = total %>% ungroup() %>% inner_join(top10, by = "year_owner") %>% filter(as.numeric(week.x) == 13),
aes(x = as.numeric(week.x), y = cum_pw.x),
nudge_x = 1.5,
direction = "y",
segment.alpha = 0) +
geom_point(data = through_week %>% ungroup() %>% inner_join(through_week_top10, by = "year_owner") %>% filter(as.numeric(week.x) == week_num),
aes(x = as.numeric(week.x), y = cum_pw.x, group = year_owner),
colour = 'red') +
#geom_line(data = through_week %>% ungroup() %>% inner_join(through_week_top10, by = "year_owner"),
#          aes(x = as.numeric(week.x), y = cum_pw.x, group = year_owner),
#          colour = 'red') +
geom_text_repel(data = through_week %>% ungroup() %>% inner_join(through_week_top10, by = "year_owner") %>% filter(as.numeric(week.x) == week_num),
aes(x = as.numeric(week.x), y = cum_pw.x),
nudge_x = -1,
#nudge_y = 100,
#direction = "y",
#segment.alpha = 0,
colour = 'red') +
ggtitle("Top 10 Single Season PW Leaders",
sub = paste0("PW Totals Through ",as.character(week_num)," Weeks; 2018 Teams in Red")) +
scale_y_continuous("Cumulative PW", lim = c(5,11)) +
scale_x_continuous("Week", lim = c(8,18),
breaks = c(10,11,12,13),
labels = c("10","11","12","13")) +
theme_minimal() +
guides(fill=FALSE, color=FALSE)
week_num <- 10
total <-
games_played %>%
group_by(year_owner) %>%
mutate(luck = W - pw) %>%
arrange(as.numeric(week)) %>%
mutate(cum_luck= cumsum(luck))
top10 <-
total %>%
ungroup() %>%
filter(as.numeric(week) == 13) %>%
arrange(cum_luck) %>%
slice(1:10)
through_week <-
games_played%>%
filter(as.numeric(week) <= week_num) %>%
group_by(year_owner) %>%
mutate(luck = W - pw) %>%
arrange(as.numeric(week)) %>%
mutate(cum_luck = cumsum(luck))
through_week_top10 <-
through_week %>%
ungroup() %>%
filter(as.numeric(week) == week_num) %>%
arrange(cum_luck) %>%
slice(1:10) %>%
filter(year == 2018)
plot <- ggplot(data = total %>% ungroup %>% inner_join(top10, by = "year_owner") %>% filter(as.numeric(week.x) >= week_num),
aes(x = as.numeric(week.x), y = cum_luck.x, group = year_owner, label = year_owner, colour = year_owner))
plot +
geom_point(pch = 1) +
geom_line(linetype = 'dotted') +
geom_text_repel(data = total %>% ungroup() %>% inner_join(top10, by = "year_owner") %>% filter(as.numeric(week.x) == 13),
aes(x = as.numeric(week.x), y = cum_luck.x),
nudge_x = 1.5,
direction = "y",
segment.alpha = 0) +
geom_point(data = through_week %>% ungroup() %>% inner_join(through_week_top10, by = "year_owner") %>% filter(as.numeric(week.x) == week_num),
aes(x = as.numeric(week.x), y = cum_luck.x, group = year_owner),
colour = 'red') +
#geom_line(data = through_week %>% ungroup() %>% inner_join(through_week_top10, by = "year_owner"),
#          aes(x = as.numeric(week.x), y = cum_luck.x, group = year_owner),
#          colour = 'red') +
geom_text_repel(data = through_week %>% ungroup() %>% inner_join(through_week_top10, by = "year_owner") %>% filter(as.numeric(week.x) == week_num),
aes(x = as.numeric(week.x), y = cum_luck.x),
nudge_x = -1,
#nudge_y = 100,
#direction = "y",
#segment.alpha = 0,
colour = 'red') +
ggtitle("Top? 10 Most Unlucky Teams",
sub = paste0("Luck Totals Through ",as.character(week_num)," Weeks; 2018 Teams in Red")) +
scale_y_continuous("Cumulative Luck", lim = c(-4,0)) +
scale_x_continuous("Week", lim = c(8,18),
breaks = c(10,11,12,13),
labels = c("10","11","12","13")) +
theme(legend.position = 'none') +
theme_minimal() +
guides(fill=FALSE, color=FALSE)
week_num <- 10
total <-
games_played %>%
group_by(year_owner) %>%
arrange(as.numeric(week)) %>%
mutate(cum_points = cumsum(points))
top10 <-
total %>%
ungroup() %>%
filter(as.numeric(week) == 13) %>%
arrange(desc(cum_points)) %>%
slice(1:10)
through_week <-
games_played%>%
filter(as.numeric(week) <= week_num) %>%
group_by(year_owner) %>%
arrange(as.numeric(week)) %>%
mutate(cum_points = cumsum(points))
through_week_top10 <-
through_week %>%
ungroup() %>%
filter(as.numeric(week) == week_num) %>%
arrange(desc(cum_points)) %>%
slice(1:10) %>%
filter(year == 2018)
plot <- ggplot(data = total %>% ungroup %>% inner_join(top10, by = "year_owner") %>% filter(as.numeric(week.x) >= week_num),
aes(x = as.numeric(week.x), y = cum_points.x, group = year_owner, label = year_owner, colour = year_owner))
plot +
geom_point(pch = 1) +
geom_line(linetype = 'dotted') +
geom_text_repel(data = total %>% ungroup() %>% inner_join(top10, by = "year_owner") %>% filter(as.numeric(week.x) == 13),
aes(x = as.numeric(week.x), y = cum_points.x),
nudge_x = 1.5,
direction = "y",
segment.alpha = 0) +
geom_point(data = through_week %>% ungroup() %>% inner_join(through_week_top10, by = "year_owner") %>% filter(as.numeric(week.x) == week_num),
aes(x = as.numeric(week.x), y = cum_points.x, group = year_owner),
colour = 'red') +
#geom_line(data = through_week %>% ungroup() %>% inner_join(through_week_top10, by = "year_owner"),
#          aes(x = as.numeric(week.x), y = cum_points.x, group = year_owner),
#          colour = 'red') +
geom_text_repel(data = through_week %>% ungroup() %>% inner_join(through_week_top10, by = "year_owner") %>% filter(as.numeric(week.x) == week_num),
aes(x = as.numeric(week.x), y = cum_points.x),
nudge_x = -1,
#nudge_y = 100,
#direction = "y",
#segment.alpha = 0,
colour = 'red') +
ggtitle("Top 10 Single Season Point Leaders",
sub = paste0("Point Totals Through ",as.character(week_num)," Weeks; 2018 Teams in Red")) +
scale_y_continuous("Cumulative Points", lim = c(1000,1650)) +
scale_x_continuous("Week", lim = c(8,18),
breaks = c(10,11,12,13),
labels = c("10","11","12","13")) +
#  theme(legend.position = 'none') +
theme_minimal() +
guides(fill=FALSE, color=FALSE)
View(through_week_top10)
week_num <- 10
total <-
games_played %>%
group_by(year_owner) %>%
arrange(as.numeric(week)) %>%
mutate(cum_pw= cumsum(pw))
top10 <-
total %>%
ungroup() %>%
filter(as.numeric(week) == 13) %>%
arrange(desc(cum_pw)) %>%
slice(1:10)
through_week <-
games_played%>%
filter(as.numeric(week) <= week_num) %>%
group_by(year_owner) %>%
arrange(as.numeric(week)) %>%
mutate(cum_pw = cumsum(pw))
through_week_top10 <-
through_week %>%
ungroup() %>%
filter(as.numeric(week) == week_num) %>%
arrange(desc(cum_pw)) %>%
slice(1:10) %>%
filter(year == 2018)
plot <- ggplot(data = total %>% ungroup %>% inner_join(top10, by = "year_owner") %>% filter(as.numeric(week.x) >= week_num),
aes(x = as.numeric(week.x), y = cum_pw.x, group = year_owner, label = year_owner, colour = year_owner))
plot +
geom_point(pch = 1) +
geom_line(linetype = 'dotted') +
geom_text_repel(data = total %>% ungroup() %>% inner_join(top10, by = "year_owner") %>% filter(as.numeric(week.x) == 13),
aes(x = as.numeric(week.x), y = cum_pw.x),
nudge_x = 1.5,
direction = "y",
segment.alpha = 0) +
geom_point(data = through_week %>% ungroup() %>% inner_join(through_week_top10, by = "year_owner") %>% filter(as.numeric(week.x) == week_num),
aes(x = as.numeric(week.x), y = cum_pw.x, group = year_owner),
colour = 'red') +
#geom_line(data = through_week %>% ungroup() %>% inner_join(through_week_top10, by = "year_owner"),
#          aes(x = as.numeric(week.x), y = cum_pw.x, group = year_owner),
#          colour = 'red') +
geom_text_repel(data = through_week %>% ungroup() %>% inner_join(through_week_top10, by = "year_owner") %>% filter(as.numeric(week.x) == week_num),
aes(x = as.numeric(week.x), y = cum_pw.x),
nudge_x = -1,
#nudge_y = 100,
#direction = "y",
#segment.alpha = 0,
colour = 'red') +
ggtitle("Top 10 Single Season PW Leaders",
sub = paste0("PW Totals Through ",as.character(week_num)," Weeks; 2018 Teams in Red")) +
scale_y_continuous("Cumulative PW", lim = c(5,11)) +
scale_x_continuous("Week", lim = c(8,18),
breaks = c(10,11,12,13),
labels = c("10","11","12","13")) +
theme_minimal() +
guides(fill=FALSE, color=FALSE)
week_num <- 10
total <-
games_played %>%
group_by(year_owner) %>%
mutate(luck = W - pw) %>%
arrange(as.numeric(week)) %>%
mutate(cum_luck= cumsum(luck))
top10 <-
total %>%
ungroup() %>%
filter(as.numeric(week) == 13) %>%
arrange(cum_luck) %>%
slice(1:10)
through_week <-
games_played%>%
filter(as.numeric(week) <= week_num) %>%
group_by(year_owner) %>%
mutate(luck = W - pw) %>%
arrange(as.numeric(week)) %>%
mutate(cum_luck = cumsum(luck))
through_week_top10 <-
through_week %>%
ungroup() %>%
filter(as.numeric(week) == week_num) %>%
arrange(cum_luck) %>%
slice(1:10) %>%
filter(year == 2018)
plot <- ggplot(data = total %>% ungroup %>% inner_join(top10, by = "year_owner") %>% filter(as.numeric(week.x) >= week_num),
aes(x = as.numeric(week.x), y = cum_luck.x, group = year_owner, label = year_owner, colour = year_owner))
plot +
geom_point(pch = 1) +
geom_line(linetype = 'dotted') +
geom_text_repel(data = total %>% ungroup() %>% inner_join(top10, by = "year_owner") %>% filter(as.numeric(week.x) == 13),
aes(x = as.numeric(week.x), y = cum_luck.x),
nudge_x = 1.5,
direction = "y",
segment.alpha = 0) +
geom_point(data = through_week %>% ungroup() %>% inner_join(through_week_top10, by = "year_owner") %>% filter(as.numeric(week.x) == week_num),
aes(x = as.numeric(week.x), y = cum_luck.x, group = year_owner),
colour = 'red') +
#geom_line(data = through_week %>% ungroup() %>% inner_join(through_week_top10, by = "year_owner"),
#          aes(x = as.numeric(week.x), y = cum_luck.x, group = year_owner),
#          colour = 'red') +
geom_text_repel(data = through_week %>% ungroup() %>% inner_join(through_week_top10, by = "year_owner") %>% filter(as.numeric(week.x) == week_num),
aes(x = as.numeric(week.x), y = cum_luck.x),
nudge_x = -1,
#nudge_y = 100,
#direction = "y",
#segment.alpha = 0,
colour = 'red') +
ggtitle("Top? 10 Most Unlucky Teams",
sub = paste0("Luck Totals Through ",as.character(week_num)," Weeks; 2018 Teams in Red")) +
scale_y_continuous("Cumulative Luck", lim = c(-4,0)) +
scale_x_continuous("Week", lim = c(8,18),
breaks = c(10,11,12,13),
labels = c("10","11","12","13")) +
theme(legend.position = 'none') +
theme_minimal() +
guides(fill=FALSE, color=FALSE)
games_played %>%
filter(as.numeric(week) <= 10) %>%
group_by(year) %>%
summarise(total_points = sum(points)) %>%
arrange(desc(total_points))
library(blogdown)
blogdown::build_site()
